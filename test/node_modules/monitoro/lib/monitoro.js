"use strict";

const path = require("path");
const fs = require("fs");
const axios = require("axios");

const monitoroConfig = JSON.parse(
  fs.readFileSync(path.resolve(process.cwd(), "monitoroConfig.json"), "utf-8")
);

const checkApiKey = () => {
  console.log(monitoroConfig);
};

const sendMessage = ({ level, contents, apiKey }) => {
  axios
    .post("http://localhost:4000/graphql", {
      query: `
    mutation SendMessage($level:String!, $contents:String!, $apiKey:String!) {
      SendMessage(level:$level, contents:$contents, apiKey:$apiKey) { 
        ok
        error
      }
    }
  `,
      variables: {
        level,
        contents,
        apiKey
      }
    })
    .then(res => console.log(res))
    .catch(err => console.log(err));
};

module.exports = { checkApiKey: checkApiKey, sendMessage: sendMessage };
